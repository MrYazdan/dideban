# Dideban Configuration Example
# Copy this file to config.yaml and modify as needed
# All values are optional - defaults will be used if not specified

# HTTP Server Configuration
server:
  # Server address and port (default: ":8080")
  # Examples: ":8080", "127.0.0.1:8080", "192.168.1.100:8080"
  # Env: DIDEBAN_SERVER_ADDR
  addr: ":8080"
  
  # Request read timeout (default: "30s")
  read_timeout: "30s"
  
  # Response write timeout (default: "30s")
  write_timeout: "30s"
  
  # Idle connection timeout (default: "60s")
  idle_timeout: "60s"
  
  # JWT Authentication Configuration
  jwt:
    # JWT secret key for signing tokens (CHANGE THIS IN PRODUCTION!)
    # Use a strong, random secret key (minimum 32 characters recommended)
    # Env: DIDEBAN_SERVER_JWT_SECRET
    secret: "your-secret-key-change-this-in-production"
    
    # JWT token time-to-live (default: "24h")
    # Examples: "1h", "24h", "7d"
    # Env: DIDEBAN_SERVER_JWT_TTL
    ttl: "24h"

# Database Configuration
#
# Dideban supports two database drivers:
#   - sqlite: for development, testing, and single-node deployments
#   - postgres: for production, high-availability, and multi-node setups
#
# Only one driver should be active at a time.
storage:
  # Database driver to use.
  # Supported values: "sqlite", "postgres"
  # Env: DIDEBAN_STORAGE_DRIVER
  driver: "sqlite"

  # Data Source Name (DSN) for the selected database.
  #
  # For SQLite:
  #   - Path to the database file (relative or absolute)
  #   - Example: "dideban.db" or "/var/lib/dideban/dideban.db"
  #
  # For Postgresql:
  #   - Standard Postgresql connection string
  #   - Format: "host=... port=... user=... password=... dbname=... sslmode=..."
  #   - Example: "host=localhost port=5432 user=dideban password=secret dbname=dideban sslmode=disable"
  #
  # Env: DIDEBAN_STORAGE_DSN
  dsn: "dideban.db"

  # Maximum number of open connections to the database.
  # Recommended:
  #   - SQLite: 10–32 (limited by WAL concurrency)
  #   - Postgresql: 20–100 (based on pool size and workload)
  # Env: DIDEBAN_STORAGE_MAX_OPEN_CONNS
  max_open_conns: 32

  # Maximum number of idle connections in the connection pool.
  # Should be <= max_open_conns.
  # Env: DIDEBAN_STORAGE_MAX_IDLE_CONNS
  max_idle_conns: 8

  # Maximum lifetime of a connection before it's closed and replaced.
  # Helps prevent stale connections in long-running services.
  # Format: duration string (e.g., "30m", "1h")
  # Env: DIDEBAN_STORAGE_CONN_MAX_LIFETIME
  conn_max_lifetime: "1h"

# Alert Configuration
alert:
  telegram:
    # Enable Telegram notifications (default: false)
    # Env: DIDEBAN_ALERT_TELEGRAM_ENABLED
    enabled: false
    
    # Telegram bot token (get from @BotFather)
    # Example: "1234567890:ABCdefGHIjklMNOpqrsTUVwxyz"
    # Env: DIDEBAN_ALERT_TELEGRAM_TOKEN
    token: ""
    
    # Chat ID or channel name (get from @userinfobot)
    # Examples: "123456789", "@channel_name"
    # Env: DIDEBAN_ALERT_TELEGRAM_CHAT_ID
    chat_id: ""
    
    # Request timeout (default: "30s")
    timeout: "30s"
  
  bale:
    # Enable Bale notifications (default: false)
    # Env: DIDEBAN_ALERT_BALE_ENABLED
    enabled: false
    
    # Bale bot token (create at https://docs.bale.ai)
    # Env: DIDEBAN_ALERT_BALE_TOKEN
    token: ""
    
    # Bale chat ID
    # Env: DIDEBAN_ALERT_BALE_CHAT_ID
    chat_id: ""
    
    # Request timeout (default: "30s")
    timeout: "30s"

# Scheduler Configuration
scheduler:
  # Number of concurrent workers for checks (default: 8)
  worker_count: 8
  
  # Default interval between checks (default: "60s")
  default_interval: "60s"
  
  # Maximum retry attempts on check failure (default: 3)
  max_retries: 3

# Check Configuration Defaults
checks:
  # HTTP/HTTPS Check Defaults
  http:
    # Default HTTP method (default: "GET")
    method: "GET"
    
    # Default headers to include in all HTTP checks
    headers: {}
    
    # Default request body (default: "")
    body: ""
    
    # Default timeout for HTTP requests in seconds (default: 10)
    timeout_seconds: 10
    
    # Default expected HTTP status code (default: 200)
    expected_status: 200
    
    # Default expected content in response (default: "")
    expected_content: ""
    
    # Follow HTTP redirects by default (default: true)
    follow_redirects: true
    
    # Verify SSL certificates by default (default: true)
    verify_ssl: true
  
  # Ping Check Defaults
  ping:
    # Default number of ping packets (default: 3)
    count: 3
    
    # Default interval between pings in milliseconds (default: 1000)
    interval_ms: 1000
    
    # Default packet size in bytes (default: 56)
    packet_size: 56
    
    # Default timeout per packet in seconds (default: 5)
    timeout_seconds: 5

# Logging Configuration
log:
  # Log level (default: "info")
  # Options: "debug", "info", "warn", "error", "fatal", "panic"
  # Env: DIDEBAN_LOG_LEVEL
  level: "info"
  
  # Human-readable console output (default: false)
  # true: colorized console output
  # false: JSON format for log systems
  # Env: DIDEBAN_LOG_PRETTY
  pretty: false